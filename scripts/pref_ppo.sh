poetry run python3.10 src/active_rlhf/scripts/pref_ppo.py \
  --exp-name="$(basename pref_ppo.py .py)" \
  --seed=1 \
  --torch-deterministic=True \
  --cuda=True \
  --track=True \
  --wandb-project-name="active-rlhf" \
  --wandb-entity="bkuen-ludwig-maximilianuniversity-of-munich" \
  --capture-video=False \
  --save-model=True \
  --upload-model=False \
  --hf-entity="" \
  --env-id="HalfCheetah-v4" \
  --total-timesteps=1000000 \
  --learning-rate=3e-4 \
  --num-envs=1 \
  --num-steps=2048 \
  --anneal-lr=True \
  --gamma=0.99 \
  --gae-lambda=0.95 \
  --num-minibatches=32 \
  --update-epochs=10 \
  --norm-adv=True \
  --clip-coef=0.2 \
  --clip-vloss=True \
  --ent-coef=0.0 \
  --vf-coef=0.5 \
  --max-grad-norm=0.5 \
  --target-kl=None \
  --replay-buffer-capacity=1000000 \
  --reward-net-epochs=15 \
  --reward-net-lr=1e-3 \
  --reward-net-weight-decay=1e-4 \
  --reward-net-batch-size=32 \
  --reward-net-minibatch-size=32 \
  --reward-net-ensemble-size=3 \
  --reward-net-dropout=0.0 \
  --reward_net_val_split=0.2 \
  --query-schedule="linear" \
  --total-queries=500 \
  --queries-per-session=10 \
  --selector-type="variquery" \
  --oversampling-factor=10.0 \
  --fragment-length=50 \
  --variquery-vae-latent-dim=16 \
  --variquery-vae-lr=1e-3 \
  --variquery-vae-weight-decay=1e-4 \
  --variquery-vae-batch-size=32 \
  --variquery-vae-num-epochs=100 \
  --variquery-vae-dropout=0.1 \
  --variquery-vae-kl-weight=1.0

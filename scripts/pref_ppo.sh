poetry run python3.10 src/active_rlhf/scripts/pref_ppo.py \
  --exp-name="variquery_v1" \
  --seed=4 \
  --torch-deterministic=True \
  --cuda=True \
  --track=True \
  --wandb-project-name="active-rlhf-tests-halfcheetah" \
  --wandb-entity="bkuen-ludwig-maximilianuniversity-of-munich" \
  --wandb-tags "variquery_v1" \
  --capture-video=False \
  --save-model=True \
  --upload-model=False \
  --hf-entity="" \
  --env-id="HalfCheetah-v4" \
  --total-timesteps=1000000 \
  --learning-rate=3e-4 \
  --num-envs=1 \
  --num-steps=2048 \
  --anneal-lr=True \
  --gamma=0.99 \
  --gae-lambda=0.95 \
  --num-minibatches=32 \
  --update-epochs=10 \
  --norm-adv=True \
  --clip-coef=0.2 \
  --clip-vloss=True \
  --ent-coef=0.0 \
  --vf-coef=0.5 \
  --max-grad-norm=0.5 \
  --target-kl=None \
  --replay-buffer-capacity=1000000 \
  --reward-net-epochs=5 \
  --reward-net-lr=3e-4 \
  --reward-net-weight-decay=1e-4 \
  --reward-net-max-grad-norm=1.0 \
  --reward-net-batch-size=32 \
  --reward-net-minibatch-size=32 \
  --reward-net-ensemble-size=3 \
  --reward-net-dropout=0.1 \
  --reward-net-hidden-dims 256 256 256 \
  --reward_net_val_split=0.2 \
  --query-schedule="linear" \
  --total-queries=1000 \
  --queries-per-session=20 \
  --selector-type="variquery" \
  --sampling-strategy="uniform" \
  --oversampling-factor=10.0 \
  --fragment-length=50 \
  --variquery-vae-latent-dim=32 \
  --variquery-vae-lr=3e-4 \
  --variquery-vae-weight-decay=1e-4 \
  --variquery-vae-batch-size=64 \
  --variquery-vae-num-epochs=100 \
  --variquery-vae-kl-warmup-epochs=40 \
  --variquery_vae_kl_warmup_steps=50 \
  --variquery_vae_early_stopping_patience=20 \
  --variquery-vae-dropout=0.0 \
  --variquery-vae-kl-weight=1.0 \
  --variquery-vae-hidden-dims 128 64 32 \
  --variquery-vae-attention-dim=128 \
  --variquery-vae-attention-heads=4 \
  --variquery_vae-attention-blocks=4 \
  --variquery-vae-decoder-layers=2 \
  --variquery_vae_noise_sigma=0.05 \
  --variquery-cluster-size=10 \
  --duo-consensual-filter=False \
  --hybrid_dpp_gamma_z=1.0 \
  --hybrid_dpp_gamma_r=1.0 \
  --hybrid_dpp_beta=0.5 \
  --save_replay_buffer=True